---
layout:     post
title:      日常笔记
subtitle:   萌新日常小笔记,随意更新！
date:       2019-11-03
author:     FormWeb
header-img: img/bg-note-web.jpeg
catalog: true
tags:
    - 日常笔记
---


### scp命令详解
```
先说下常用的情况：

两台机器IP分别为：A.104.238.161.75，B.43.224.34.73。

在A服务器上操作，将B服务器上/home/lk/目录下所有的文件全部复制到本地的/root目录下，命令为：scp -r root@43.224.34.73:/home/lk /root。

具体过程为：

复制代码
[root@XX ~]# scp -r root@43.224.34.73:/home/lk /root
root@43.224.34.73's password: 
k2.sql                                                     100%    0     0.0KB/s   00:00    
k.zip                                                      100%  176     0.2KB/s   00:00    
.bash_history                                              100%   32     0.0KB/s   00:00    
.bash_logout                                               100%   18     0.0KB/s   00:00    
.bashrc                                                    100%  231     0.2KB/s   00:00    
k3.sql                                                     100%    0     0.0KB/s   00:00    
.bash_profile                                              100%  193     0.2KB/s   00:00    
[root@XX ~]# ls
复制代码
在A服务器上将/root/lk目录下所有的文件传输到B的/home/lk/cpfile目录下，命令为：scp -r /root/lk root@43.224.34.73:/home/lk/cpfile。

具体过称为：

复制代码
[root@XX lk]# scp -r /root/lk root@43.224.34.73:/home/lk/cpfile
root@43.224.34.73's password: 
k2.sql                                                     100%    0     0.0KB/s   00:00    
k3.sql                                                     100%    0     0.0KB/s   00:00    
.bash_profile                                              100%  193     0.2KB/s   00:00    
.bash_logout                                               100%   18     0.0KB/s   00:00    
.bash_history                                              100%   32     0.0KB/s   00:00    
k.zip                                                      100%  176     0.2KB/s   00:00    
.bashrc                                                    100%  231     0.2KB/s   00:00    
[root@XX lk]# 
复制代码
scp在夸机器复制的时候为了提高数据的安全性，使用了ssh连接和加密方式，如果机器之间配置了ssh免密码登录，那在使用scp的时候密码都不用输入。

命令详解：

scp是secure copy的简写，用于在Linux下进行远程拷贝文件的命令，和它类似的命令有cp，不过cp只是在本机进行拷贝不能跨服务器，而且scp传输是加密的。可能会稍微影响一下速度。当你服务器硬盘变为只读 read only system时，用scp可以帮你把文件移出来。另外，scp还非常不占资源，不会提高多少系统负荷，在这一点上，rsync就远远不及它了。虽然 rsync比scp会快一点，但当小文件众多的情况下，rsync会导致硬盘I/O非常高，而scp基本不影响系统正常使用。

1．命令格式：

scp [参数] [原路径] [目标路径]

2．命令功能：

scp是 secure copy的缩写, scp是linux系统下基于ssh登陆进行安全的远程文件拷贝命令。linux的scp命令可以在linux服务器之间复制文件和目录。

3．命令参数：

-1  强制scp命令使用协议ssh1  

-2  强制scp命令使用协议ssh2  

-4  强制scp命令只使用IPv4寻址  

-6  强制scp命令只使用IPv6寻址  

-B  使用批处理模式（传输过程中不询问传输口令或短语）  

-C  允许压缩。（将-C标志传递给ssh，从而打开压缩功能）  

-p 保留原文件的修改时间，访问时间和访问权限。  

-q  不显示传输进度条。  

-r  递归复制整个目录。  

-v 详细方式显示输出。scp和ssh(1)会显示出整个过程的调试信息。这些信息用于调试连接，验证和配置问题。   

-c cipher  以cipher将数据传输进行加密，这个选项将直接传递给ssh。   

-F ssh_config  指定一个替代的ssh配置文件，此参数直接传递给ssh。  

-i identity_file  从指定文件中读取传输时使用的密钥文件，此参数直接传递给ssh。    

-l limit  限定用户所能使用的带宽，以Kbit/s为单位。     

-o ssh_option  如果习惯于使用ssh_config(5)中的参数传递方式，   

-P port  注意是大写的P, port是指定数据传输用到的端口号   

-S program  指定加密传输时所使用的程序。此程序必须能够理解ssh(1)的选项。

4．使用实例：

scp命令的实际应用概述：  

从本地服务器复制到远程服务器： 

(1) 复制文件：  

命令格式：  

scp local_file remote_username@remote_ip:remote_folder  

或者  

scp local_file remote_username@remote_ip:remote_file  

或者  

scp local_file remote_ip:remote_folder  

或者  

scp local_file remote_ip:remote_file  

第1,2个指定了用户名，命令执行后需要输入用户密码，第1个仅指定了远程的目录，文件名字不变，第2个指定了文件名  

第3,4个没有指定用户名，命令执行后需要输入用户名和密码，第3个仅指定了远程的目录，文件名字不变，第4个指定了文件名   

(2) 复制目录：  

命令格式：  

scp -r local_folder remote_username@remote_ip:remote_folder  

或者  

scp -r local_folder remote_ip:remote_folder  

第1个指定了用户名，命令执行后需要输入用户密码；  

第2个没有指定用户名，命令执行后需要输入用户名和密码；
```


### 删除所有小于100K的文件
```
find . -type f -size -100k -print | grep -v "jpg\|JPG" | xargs -0 -n1 rm -rf

find  -print 打印 prit0 不打印
size  +100 -100 100占空间大小 0c 100c文件大小
find  -type d文件夹 -empty空文件夹 f文件
grep  -v 排除指定字符
xargs -0 处理特定字符
```
```
find . -name "shuaige.txt" -exec rm -f {} ;  

”；“可以没有

find ./ -name "*.torrent" -exec rm -rf {} \;
-exec 必须有- 后面命令参数占位{} 和 \; 都得有

```

### Fdupes查找删除重复文件并删除空目录
```
Fdupes 用法非常简单。仅运行下面的命令就可以在目录中找到重复文件，如：~/Downloads。  
$ fdupes ~/Downloads
我系统中的样例输出：
/home/sk/Downloads/Hyperledger.pdf 
/home/sk/Downloads/Hyperledger(1).pdf  
你可以看到，在 /home/sk/Downloads/ 目录下有一个重复文件。它仅显示了父级目录中的重复文件。如何显示子目录中的重复文件？像下面一样，使用 -r 选项。
$ fdupes -r ~/Downloads
现在你将看到 /home/sk/Downloads/ 目录以及子目录中的重复文件。

Fdupes 也可用来从多个目录中迅速查找重复文件。
$ fdupes ~/Downloads ~/Documents/ostechnix
你甚至可以搜索多个目录，递归搜索其中一个目录，如下：

$ fdupes ~/Downloads -r ~/Documents/ostechnix
上面的命令将搜索 ~/Downloads 目录，~/Documents/ostechnix 目录和它的子目录中的重复文件。

有时，你可能想要知道一个目录中重复文件的大小。你可以使用 -S 选项，如下：

$ fdupes -S ~/Downloads
403635 bytes each:
/home/sk/Downloads/Hyperledger.pdf
/home/sk/Downloads/Hyperledger(1).pdf
类似的，为了显示父目录和子目录中重复文件的大小，使用 -Sr 选项。

我们可以在计算时分别使用 -n 和 -A 选项排除空白文件以及排除隐藏文件。

$ fdupes -n ~/Downloads
$ fdupes -A ~/Downloads
在搜索指定目录的重复文件时，第一个命令将排除零长度文件，后面的命令将排除隐藏文件。

汇总重复文件信息，使用 -m 选项。

$ fdupes -m ~/Downloads
1 duplicate files (in 1 sets), occupying 403.6 kilobytes
删除所有重复文件，使用 -d 选项。

$ fdupes -d ~/Downloads
样例输出：

[1] /home/sk/Downloads/Hyperledger Fabric Installation.pdf
[2] /home/sk/Downloads/Hyperledger Fabric Installation(1).pdf

Set 1 of 1, preserve files [1 - 2, all]:
这个命令将提示你保留还是删除所有其他重复文件。输入任一号码保留相应的文件，并删除剩下的文件。当使用这个选项的时候需要更加注意。如果不小心，你可能会删除原文件。

如果你想要每次保留每个重复文件集合的第一个文件，且无提示的删除其他文件，使用 -dN 选项（不推荐）。

$ fdupes -dN ~/Downloads
当遇到重复文件时删除它们，使用 -I 标志。

$ fdupes -I ~/Downloads
关于 Fdupes 的更多细节，查看帮助部分和 man 页面。

$ fdupes --help
$ man fdupes
```
[原文地址](https://linux.cn/article-10123-1.html?pr)


### 文件内容查找和替换命令
<font size="2" color="gray">2019-11-04</font>  
几种常见的文件内容查找和替换命令
#### 1. 通过vim编辑器来替换
```
vi/vim 中可以使用 :s 命令来替换字符串。

:s/well/good/ 替换当前行第一个 well 为 good

:s/well/good/g 替换当前行所有 well 为 good

:n,$s/well/good/ 替换第 n 行开始到最后一行中每一行的第一个 well 为 good

:n,$s/well/good/g 替换第 n 行开始到最后一行中每一行所有 well 为 good n 为数字，若 n 为 .，表示从当前行开始到最后一行

:%s/well/good/（等同于 :g/well/s//good/） 替换每一行的第一个 well 为 good

:%s/well/good/g（等同于 :g/well/s//good/g） 替换每一行中所有 well 为 good 可以使用 # 作为分隔符，此时中间出现的 / 不会作为分隔符

:s#well/#good/# 替换当前行第一个 well/ 为 good/

```
#### 2. sed和grep配合
```
sed -i s/yyyy/xxxx/g `grep yyyy -rl --include="*.txt" ./`

作用：将当前目录(包括子目录)中所有txt文件中的yyyy字符串替换为xxxx字符串。其中，

-i 表示操作的是文件，``括起来的grep命令，表示将grep命令的的结果作为操作文件。

s/yyyy/xxxx/表示查找yyyy并替换为xxxx，后面跟g表示一行中有多个yyyy的时候，都替换，而不是仅替换第一个

另外，如果不需要查找子目录，仅需要在当前目录替换，用sed命令就行了，命令如下：sed -i s/xxxx/yyyy/g ./*.txt

```
#### 3. find命令查找和替换
```
find -name '要查找的文件名' | xargs perl -pi -e 's|被替换的字符串|替换后的字符串|g'          #查找替换当前目录下包含字符串并进行替换

find -name '*.txt' | xargs perl -pi -e 's|被替换内容|替换内容|g'             #递归查找替换

find . -type f -name '*.html' | xargs perl -pi -e 's|被替换内容|替换内容|g'

```
我用到的：  

```
find . -type f -name '*.html' | xargs perl -pi -e 's/utf-8/iso-8859-1/g'  
```
[原文链接](https://blog.csdn.net/qq_25992179/article/details/82777486)


### wget整站克隆仿站
<font size="2" color="gray">2019-11-03</font>  
通过如下命令可以整个网站的源码下载到本地
```
$ wget -r -p -np -k www.avatrade.cn
```
Wget参数说明:   
```
-r --recursive（递归） specify recursive download.（指定递归下载）
-k --convert-links（转换链接） make links in downloaded HTML point to local files.（将下载的HTML页面中的链接转换为相对链接即本地链接）
-p --page-requisites（页面必需元素） get all images, etc. needed to display HTML page.（下载所有的图片等页面显示所需的内容）
-np --no-parent（不追溯至父级） don't ascend to the parent directory.

这里写代码片额外参数：

-nc  断点续传
-o   生成日志文件
```  
[原文链接](https://blog.csdn.net/qq_28590879/article/details/79849307)

### ffmpeg转码
```
ffmpeg -i in.rm -c:v h264 -c:a aac "out.mp4"
```